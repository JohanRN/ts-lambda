"use strict";var o=Object.defineProperty;var u=Object.getOwnPropertyDescriptor;var c=Object.getOwnPropertyNames;var p=Object.prototype.hasOwnProperty;var g=(s,t)=>{for(var e in t)o(s,e,{get:t[e],enumerable:!0})},m=(s,t,e,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of c(t))!p.call(s,r)&&r!==e&&o(s,r,{get:()=>t[r],enumerable:!(i=u(t,r))||i.enumerable});return s};var f=s=>m(o({},"__esModule",{value:!0}),s);var V={};g(V,{handler:()=>b});module.exports=f(V);var l=class{constructor(t,e,i){this.status=t;this.message=e;this.data=i;this.status=t,this.message=e,this.data=i}res(){return{status:this.status,message:this.message,data:this.data}}},h=l;var n=class{constructor(t,e,i,r,a){this.email=t;this.car_number=e;this.cvv=i;this.expiration_year=r;this.expiration_month=a;if(!this.isValidEmail(t))throw new Error("Correo es invalido");if(!this.isValidCardNumber(e))throw new Error("Numero de tarjeta  invalido");if(!this.isValidCVV(i,e))throw new Error("CVV invalido");if(!this.isValidYear(r))throw new Error("A\xF1o de expiraci\xF3n invalido");if(!this.isValidMonth(a))throw new Error("Mes de expiraci\xF3n invalido");this.email=t,this.car_number=e,this.cvv=i,this.expiration_year=r,this.expiration_month=a}isValidEmail(t){let e=["gmail.com","hotmail.com","yahoo.es"];if(/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t)){let r=t.split("@")[1];return e.includes(r)}return!1}isValidCardNumber(t){return/^\d{13,16}$/.test(t)&&this.luhnCheck(t)}luhnCheck(t){let e=0,i=!1;for(let r=t.length-1;r>=0;r--){let a=parseInt(t[r]);i&&(a*=2,a>9&&(a-=9)),e+=a,i=!i}return e%10===0}isValidCVV(t,e){return/^\d{3}$/.test(t)&&["Visa","Mastercard"].includes(this.getCardType(e))||/^\d{4}$/.test(t)&&this.getCardType(e)==="Amex"}getCardType(t){return/^4/.test(t)?"Visa":/^5[1-5]/.test(t)?"Mastercard":/^3[47]/.test(t)?"Amex":"Unknown"}isValidYear(t){let e=new Date().getFullYear(),i=e+5;return/^\d{4}$/.test(t)&&parseInt(t)>=e&&parseInt(t)<=i}isValidMonth(t){return/^(0?[1-9]|1[0-2])$/.test(t)}return(){return new n(this.email,this.car_number,this.cvv,this.expiration_year,this.expiration_month)}},d=n;var b=async s=>{try{let t=JSON.parse(s.body||"{}"),e=new d(t.email,t.car_number,t.cvv,t.expiration_year,t.expiration_month).return();return console.log(s.headers.Authorization),{statusCode:200,body:JSON.stringify(new h(200,"OK",[]).res())}}catch(t){return{statusCode:500,body:JSON.stringify(new h(500,t.message,[]).res())}}};0&&(module.exports={handler});
//# sourceMappingURL=token.js.map
